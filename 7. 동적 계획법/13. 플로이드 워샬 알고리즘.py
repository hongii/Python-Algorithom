# í”Œë¡œì´ë“œ ì›Œìƒ¬ ì•Œê³ ë¦¬ì¦˜ : ëª¨ë“  ì •ì ì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œì˜ ìµœë‹¨ê±°ë¦¬ êµ¬í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜
# ë”°ë¼ì„œ, 2ì°¨ì› dp í…Œì´ë¸”ì´ í•„ìš”í•˜ë‹¤.
# ê° ë‹¨ê³„ë§ˆë‹¤ íŠ¹ì •í•œ ë…¸ë“œ ğ‘˜ë¥¼ ê±°ì³ ê°€ëŠ” ê²½ìš°ë¥¼ í™•ì¸í•œë‹¤. ì¦‰, iì—ì„œ jë¡œ ê°€ëŠ” ìµœë‹¨ ê±°ë¦¬ë³´ë‹¤ iì—ì„œ ğ‘˜ë¥¼ ê±°ì³ jë¡œ ê°€ëŠ” ê±°ë¦¬ê°€ ë” ì§§ì€ì§€ ê²€ì‚¬í•œë‹¤

'''
2ì°¨ì› dp í…Œì´ë¸”ì˜ ì´ˆê¸°ê°’ -> ì¸ì ‘í–‰ë ¬ì„ ì±„ì›Œë„£ëŠ”ë‹¤.(ê°„ì„ ì´ ì—°ê²°ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê³³ì€ ë¬´í•œëŒ€ ê°’ì„ ë„£ì–´ì¤€ë‹¤)

â–£ ì…ë ¥ì„¤ëª…
ì²« ë²ˆì§¸ ì¤„ì—ëŠ” ë„ì‹œì˜ ìˆ˜N(N<=100)ê³¼ ë„ë¡œìˆ˜ M(M<=200)ê°€ ì£¼ì–´ì§€ê³ , Mì¤„ì— ê±¸ì³ ë„ë¡œì •ë³´ì™€ 
ë¹„ìš©(20 ì´í•˜ì˜ ìì—°ìˆ˜)ì´ ì£¼ì–´ì§„ë‹¤. ë§Œì•½ 1ë²ˆ ë„ì‹œì™€ 2ë²ˆë„ì‹œê°€ ì—°ê²°ë˜ê³  ê·¸ ë¹„ìš©ì´ 13ì´ë©´ 
â€œ1 2 13â€ìœ¼ë¡œ ì£¼ì–´ì§„ë‹¤. 

â–£ ì…ë ¥ì˜ˆì œ 1
5 8
1 2 6
1 3 3
3 2 2
2 4 1
2 5 13
3 4 5
4 2 3
4 5 7
                    ì •ì ë²ˆí˜¸:  0  1  2  3  4  5    (0ë²ˆ ì •ì ì€ ë¬´ì‹œ(ë”ë¯¸ê°’), ì •ì ì€ 1~në²ˆê¹Œì§€)
=> ì´ˆê¸° dp í…Œì´ë¸” ì •ë³´ : dp = [[inf, inf, inf, inf, inf, inf],
                              [inf, 0, 6, 3, inf, inf],
                              [inf, inf, 0, inf, 1, 13],
                              [inf, inf, 2, 0, 5, inf],
                              [inf, inf, 3, inf, 0, 7],
                              [inf, inf, inf, inf, inf, 0]]

* dp[i][j]ì˜ ì˜ë¯¸: ì •ì  i -> j ë¡œ ê°€ëŠ” ìµœì†Œ ë¹„ìš©ê°’ / k: i -> j ê¹Œì§€ ê°€ëŠ”ë° ì¡´ì¬í•˜ëŠ” ì¤‘ê°„ ê²½ìœ ì§€
dp[i][j] = min(dp[i][j], dp[i][k] + dp[k][j])  -> 3ì¤‘ forë¬¸ ì‚¬ìš© (kê°€ 1~nê¹Œì§€, i -> jë¡œ ê°€ëŠ” 2ì¤‘ forë¬¸)

'''

import sys
filePath_laptop = "C:\\Users\khj77\\OneDrive\\ë°”íƒ• í™”ë©´\\Python\\python_Algo_practice\\Python-Algorithom\\7. ë™ì  ê³„íšë²•\\input.txt"
filePath_desktop = "C:\\Users\\cywoo\\OneDrive\\ë°”íƒ• í™”ë©´\\Python\\python_algo_practice\\Python-Algorithom\\7. ë™ì  ê³„íšë²•\\input.txt"
sys.stdin = open(filePath_desktop, "rt")

n, m = map(int, input().split())
M = int(1e9) # M = 10ì–µ(ë¬´í•œëŒ€ ê°’)
dp = [[M] * (n+1) for _ in range(n+1)]

for i in range(1, n+1): # ìê¸° ìì‹ ìœ¼ë¡œ ê°€ëŠ” ë¹„ìš©ì€ 0ìœ¼ë¡œ ê°±ì‹ 
  dp[i][i] = 0

# dpí…Œì´ë¸” ì´ˆê¸°ê°’ì€ ì¸ì ‘í–‰ë ¬ ê°„ì„  ê°€ì¤‘ì¹˜ ê°’ìœ¼ë¡œ ê°±ì‹ 
for i in range(m):
  i, j, w = map(int, input().split())
  dp[i][j] = w

# ëª¨ë“  ì •ì ì—ì„œ ëª¨ë“  ì •ì ìœ¼ë¡œ ê°€ëŠ” ìµœì†Œë¹„ìš© êµ¬í•˜ê¸°
for k in range(1, n+1):
  for i in range(1, n+1):
    for j in range(1, n+1):
      dp[i][j] = min(dp[i][j], dp[i][k] + dp[k][j])

for i in range(1, n+1):
  for j in range(1, n+1):
    if dp[i][j] == 1e9:
      print("M", end=" ")
    else:
      print(dp[i][j], end=" ")
  print()
